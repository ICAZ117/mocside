(self.webpackChunk=self.webpackChunk||[]).push([[838],{838:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>L});var r=n(5166),a={key:0},o=(0,r.createVNode)("div",{class:"courses header"},[(0,r.createVNode)("div",{class:"heading"},[(0,r.createVNode)("h2",null,"Labs"),(0,r.createVNode)("hr")])],-1),s={class:"navigation"},c=(0,r.createVNode)("br",null,null,-1),i={class:"table labtable"},l={class:"labtable"},u=(0,r.createVNode)("th",null,"Title",-1),d=(0,r.createVNode)("th",null,"# Problems",-1),p={key:0},b=(0,r.createVNode)("th",null,"Due Date",-1),m={key:1},f={key:0},h={key:1},k=(0,r.createVNode)("td",{colspan:"5"},"Add Lab",-1),g={id:"menu"},v={class:"menu-item"},N={class:"menu-item"};var y=n(7757),x=n.n(y),D=n(6532),w=n(2813),V=n(2119);function C(e,t,n,r,a,o,s){try{var c=e[o](s),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,a)}function B(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){C(o,r,a,s,c,"next",e)}function c(e){C(o,r,a,s,c,"throw",e)}s(void 0)}))}}const I={props:["courseID"],emits:["unmounting","courseEdited"],data:function(){return{labs:[],childisOpen:!1,labID:null,labName:null,authUser:null,fscID:null,progress:[],username:"",rightClickID:""}},setup:function(){var e=(0,V.yj)();return{currentDirectory:(0,r.computed)((function(){return e.path}))}},methods:{showMenu:function(e){if(this.isProf){this.rightClickID=String(e);var t=document.getElementById(this.rightClickID).childNodes[0],n=document.getElementById("out-click");t.style.top="".concat(window.event.clientY,"px"),t.style.left="".concat(window.event.clientX,"px"),t.classList.add("show"),n.style.display="block"}},closeMenu:function(){try{document.getElementById(this.rightClickID).childNodes[0].classList.remove("show")}catch(e){}document.getElementById("out-click").style.display="none",this.rightClickID=""},goToProblems:function(e,t){this.childisOpen=!0,this.labID=e,this.labName=t,this.$router.push({name:"Problems",params:{lab_id:e}})},getLabs:function(){var e=this;return B(x().mark((function t(){var n,r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.x.get("/labs/".concat(e.courseID));case 2:return n=t.sent,e.labs=n.data.data,t.next=6,e.getStudent();case 6:if(t.sent,e.isProf){t.next=19;break}r=0;case 9:if(!(r<e.labs.length)){t.next=19;break}return t.next=12,e.getPercent(e.labs[r]);case 12:return e.labs[r].percent=t.sent,t.next=15,e.getActivity(e.labs[r]);case 15:e.labs[r].activity=t.sent;case 16:r++,t.next=9;break;case 19:case"end":return t.stop()}}),t)})))()},sortLabs:function(){var e=this;return B(x().mark((function t(){var n;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.labs.sort((function(e,t){return new Date(e.due_date)-new Date(t.due_date)})),t.abrupt("return",n);case 2:case"end":return t.stop()}}),t)})))()},Unmounting:function(){this.childisOpen=!1,this.labID=null,this.labName=null,this.$router.push({name:"Labs",params:{course_id:this.courseID}})},labEdited:function(){var e=this;return B(x().mark((function t(){var n;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.labs=e.labs.filter((function(t){return t.id!=e.labID})),t.next=3,D.x.get("/labs/full/".concat(e.labID));case 3:n=t.sent,e.labs.push(n.data.data),e.Unmounting();case 6:case"end":return t.stop()}}),t)})))()},addLab:function(){var e=this;return B(x().mark((function t(){var n,r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={name:"New Lab",description:"New Lab",course_id:e.courseID,due_date:"2021-06-03"},t.next=3,D.x.post("/labs/",n);case 3:r=t.sent,e.labs.push(r.data.data),console.log(r.data.data),e.labID=r.data.data.id,e.labName=r.data.data.name,console.log(e.labID),e.childisOpen=!0,e.$router.push({name:"EditLab",params:{lab_id:e.labID}});case 11:case"end":return t.stop()}}),t)})))()},editLab:function(e,t){this.childisOpen=!0,this.labID=e,this.labName=t,this.$router.push({name:"EditLab",params:{lab_id:this.labID}})},removeLab:function(e,t){var n=this;return B(x().mark((function r(){return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!confirm("Are you Sure you want to remove "+labName+" from this Course?")){r.next=6;break}return r.next=4,D.x.delete("/labs/".concat(e));case 4:r.sent,n.labs=n.labs.filter((function(e,n){return n!=t}));case 6:case"end":return r.stop()}}),r)})))()},getStudent:function(){var e=this;return B(x().mark((function t(){var n;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.authUser=w.Z.getters["auth/authUser"],e.fscID=e.authUser.fsc_user.fsc_id,t.next=4,D.x.get("/progress/".concat(e.fscID));case 4:return n=t.sent,e.progress=n.data.data,t.abrupt("return",e.progress);case 7:case"end":return t.stop()}}),t)})))()},getPercent:function(e){var t=this;return B(x().mark((function n(){var r,a,o;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=JSON.parse(t.progress.labs),o=0;case 2:if(!(o<r.length)){n.next=9;break}if(r[o].lab_id!=e.id){n.next=6;break}return a=r[o],n.abrupt("break",9);case 6:o++,n.next=2;break;case 9:if(0!=e.numProblems){n.next=13;break}return n.abrupt("return","0%");case 13:if(a){n.next=17;break}return n.abrupt("return","0%");case 17:return n.abrupt("return",parseInt(a.num_completed/e.num_problems*100)+"%");case 18:case"end":return n.stop()}}),n)})))()},getActivity:function(e){var t=this;return B(x().mark((function n(){var r,a;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=JSON.parse(t.progress.labs),a=0;case 2:if(!(a<r.length)){n.next=8;break}if(r[a].lab_id!=e.id){n.next=5;break}return n.abrupt("return",r[a].last_progress);case 5:a++,n.next=2;break;case 8:case"end":return n.stop()}}),n)})))()},routeToChild:function(){var e=window.location.pathname,t="/courses/"+this.courseID+"/labs";if(""==(n=e.substring(t.length)))console.log("just on the labs page");else{console.log("on this page: "+n);for(var n,r=(n=n.split("/"))[1],a=n[2],o="",s=0;s<this.labs.length;s++)if(this.labs[s].id==r){o=this.labs[s].name;break}"problems"==a?this.goToProblems(r,o):"edit"==a?this.editLab(r,o):console.log(a)}}},computed:{isProf:function(){return null!=w.Z.getters["auth/isProf"]&&w.Z.getters["auth/isProf"]}},mounted:function(){var e=this;return B(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.Z.getters["auth/authUser"];case 2:e.authUser=t.sent,e.username=e.authUser.username,e.routeToChild();case 5:case"end":return t.stop()}}),t)})))()},beforeMount:function(){var e=this;return B(x().mark((function t(){var n;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.childisOpen=!1,t.next=3,e.getLabs();case 3:return t.next=5,e.sortLabs();case 5:n=t.sent,console.log(n);case 7:case"end":return t.stop()}}),t)})))()},beforeUnmount:function(){this.$emit("unmounting")},render:function(e,t,n,y,x,D){var w=this,V=(0,r.resolveComponent)("router-view");return(0,r.openBlock)(),(0,r.createBlock)(r.Fragment,null,[x.childisOpen?(0,r.createCommentVNode)("",!0):((0,r.openBlock)(),(0,r.createBlock)("div",a,[o,(0,r.createVNode)("small",s,[(0,r.createVNode)("span",null,(0,r.toDisplayString)(x.username)+(0,r.toDisplayString)(y.currentDirectory),1),c,(0,r.createVNode)("span",{class:"pointer underline",onClick:t[1]||(t[1]=function(e){return w.$emit("unmounting")})},"â†© Return to Courses")]),(0,r.createVNode)("table",i,[(0,r.createVNode)("thead",l,[(0,r.createVNode)("tr",null,[u,d,D.isProf?(0,r.createCommentVNode)("",!0):((0,r.openBlock)(),(0,r.createBlock)("th",p,"% Complete")),b,D.isProf?(0,r.createCommentVNode)("",!0):((0,r.openBlock)(),(0,r.createBlock)("th",m,"Last Activity"))])]),(0,r.createVNode)("tbody",null,[((0,r.openBlock)(!0),(0,r.createBlock)(r.Fragment,null,(0,r.renderList)(x.labs,(function(e){return(0,r.openBlock)(),(0,r.createBlock)(r.Fragment,{key:e.id},[D.isProf?(0,r.createCommentVNode)("",!0):((0,r.openBlock)(),(0,r.createBlock)("tr",{key:0,class:"lab pointer",onClick:function(t){return D.goToProblems(e.id,e.name)}},[(0,r.createVNode)("td",null,[(0,r.createVNode)("a",null,(0,r.toDisplayString)(e.name),1)]),(0,r.createVNode)("td",null,(0,r.toDisplayString)(e.num_problems),1),D.isProf?(0,r.createCommentVNode)("",!0):((0,r.openBlock)(),(0,r.createBlock)("td",f,(0,r.toDisplayString)(e.percent),1)),(0,r.createVNode)("td",null,(0,r.toDisplayString)(e.due_date),1),D.isProf?(0,r.createCommentVNode)("",!0):((0,r.openBlock)(),(0,r.createBlock)("td",h,(0,r.toDisplayString)(e.activity),1))],8,["onClick"])),D.isProf?((0,r.openBlock)(),(0,r.createBlock)("tr",{key:1,class:"lab pointer",onClick:(0,r.withModifiers)((function(t){return D.goToProblems(e.id,e.name)}),["prevent"]),onContextmenu:(0,r.withModifiers)((function(t){return D.showMenu(e.id)}),["prevent"])},[(0,r.createVNode)("td",null,[(0,r.createVNode)("a",null,(0,r.toDisplayString)(e.name),1)]),(0,r.createVNode)("td",null,(0,r.toDisplayString)(e.num_problems),1),(0,r.createVNode)("td",null,(0,r.toDisplayString)(e.due_date),1)],40,["onClick","onContextmenu"])):(0,r.createCommentVNode)("",!0)],64)})),128)),D.isProf?((0,r.openBlock)(),(0,r.createBlock)("tr",{key:0,class:"lab pointer",onClick:t[2]||(t[2]=function(){return D.addLab&&D.addLab.apply(D,arguments)})},[k])):(0,r.createCommentVNode)("",!0)])])])),x.childisOpen?((0,r.openBlock)(),(0,r.createBlock)(V,{key:1,onUnmounting:t[3]||(t[3]=function(e){return D.Unmounting()}),onLabEdited:t[4]||(t[4]=function(e){return D.labEdited()}),labID:x.labID,labName:x.labName},null,8,["labID","labName"])):(0,r.createCommentVNode)("",!0),((0,r.openBlock)(!0),(0,r.createBlock)(r.Fragment,null,(0,r.renderList)(x.labs,(function(e,t){return(0,r.openBlock)(),(0,r.createBlock)("div",{key:e.id},[(0,r.createVNode)("div",{id:e.id},[(0,r.createVNode)("ul",g,[(0,r.createVNode)("li",v,[D.isProf?((0,r.openBlock)(),(0,r.createBlock)("a",{key:0,class:"pointer no-decor",onClick:function(t){return D.editLab(e.id,e.name)}},"Edit",8,["onClick"])):(0,r.createCommentVNode)("",!0)]),(0,r.createVNode)("li",N,[D.isProf?((0,r.openBlock)(),(0,r.createBlock)("a",{key:0,class:"pointer no-decor",onClick:function(n){return D.removeLab(e.id,t)}},"Delete",8,["onClick"])):(0,r.createCommentVNode)("",!0)])])],8,["id"])])})),128)),(0,r.createVNode)("div",{id:"out-click",onClick:t[5]||(t[5]=function(){return D.closeMenu&&D.closeMenu.apply(D,arguments)})})],64)}},L=I}}]);