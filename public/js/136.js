(self.webpackChunk=self.webpackChunk||[]).push([[136],{2684:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(5166);const o={name:"BaseBtn",props:{type:{type:String,default:"submit"},text:{type:String,default:"Submit"}},render:function(e,t,r,o,a,s){return(0,n.openBlock)(),(0,n.createBlock)("button",(0,n.mergeProps)({type:r.type},e.$attrs,{class:"px-2.5 py-1.5 border border-transparent text-xs rounded shadow-sm text-white bg-blue-400 hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 text-center transition"}),(0,n.toDisplayString)(r.text),17,["type"])}},a=o},4136:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ne});var n=r(5166),o={class:"edit-course"},a=(0,n.createVNode)("h3",{class:"edit-course-title"},"Edit Course",-1),s={class:"course-create-form"},c={class:"form-group"},u=(0,n.createVNode)("label",{for:"Course Name"},"Course Name",-1),l=(0,n.createVNode)("br",null,null,-1),i={class:"form-group"},d=(0,n.createVNode)("label",{for:"Course Description"},"Course Description",-1),p=(0,n.createVNode)("br",null,null,-1),f={class:"form-group"},m={class:"mb-4"},v=(0,n.createVNode)("label",{for:"file",class:"sr-only"}," Upload Course Image ",-1),y=(0,n.createVNode)("br",null,null,-1),h={class:"form-group"},g=(0,n.createVNode)("label",{for:"Course Dates"},"Course Dates",-1),x={class:"row"},b=(0,n.createVNode)("br",null,null,-1),k={class:"form-group"},N=(0,n.createVNode)("label",{for:"Course Roster"},"Course Roster",-1),V=(0,n.createVNode)("br",null,null,-1),w={class:"form-group"},F={class:"key-options"},S=(0,n.createVNode)("label",null,"Enroll Key",-1),C=(0,n.createVNode)("br",null,null,-1),D=(0,n.createVNode)("label",null,"Permanent Key",-1),K={class:"switch"},B=(0,n.createVNode)("span",{class:"slider round"},null,-1),_=(0,n.createVNode)("br",null,null,-1),M=(0,n.createVNode)("label",null,"Expire Date",-1),U=(0,n.createVNode)("br",null,null,-1),E=(0,n.createVNode)("label",null,"Expire Time",-1),I=(0,n.createVNode)("br",null,null,-1),T=(0,n.createVNode)("label",null,"Max Uses",-1),j=(0,n.createVNode)("br",null,null,-1),P=(0,n.createVNode)("div",{class:"form-group"},[(0,n.createVNode)("button",{type:"submit",class:"btn btn-danger btn-block"}," Submit Changes ")],-1);var R=r(7757),J=r.n(R),L=r(6532),O=r(7181);function $(e,t,r,n,o,a,s){try{var c=e[a](s),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}const Z=function(e){return(t=J().mark((function t(){var r;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L.x.post(e.endpoint,e.file);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function s(e){$(a,n,o,s,c,"next",e)}function c(e){$(a,n,o,s,c,"throw",e)}s(void 0)}))})();var t};var q={key:0,class:"mt-2 text-sm text-green-500"},A={key:1,class:"mt-2 text-sm text-red-500"};const G={name:"FlashMessage",props:{message:{type:String,default:null},error:{type:[Error,String],default:null}},render:function(e,t,r,o,a,s){return(0,n.openBlock)(),(0,n.createBlock)("div",null,[r.message?((0,n.openBlock)(),(0,n.createBlock)("p",q,(0,n.toDisplayString)(r.message),1)):(0,n.createCommentVNode)("",!0),r.error?((0,n.openBlock)(),(0,n.createBlock)("p",A,(0,n.toDisplayString)(r.error),1)):(0,n.createCommentVNode)("",!0)])}},X=G;var z={class:"mb-4"},H={for:"file",class:"sr-only"};var Q=r(2684);function W(e,t,r,n,o,a,s){try{var c=e[a](s),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}const Y={name:"FileUpload",props:{fileTypes:{type:Array,default:null},endpoint:{type:String,required:!0},label:{type:String,default:""}},components:{BaseBtn:Q.Z,FlashMessage:X},data:function(){return{file:null,message:null,error:null}},methods:{clearMessage:function(){this.error=null,this.message=null},fileChange:function(e){this.clearMessage(),this.file=e.target.files[0]},uploadFile:function(){var e,t=this;return(e=J().mark((function e(){var r,n;return J().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},(n=new FormData).append("file",t.file),r.file=n,r.endpoint=t.endpoint,t.clearMessage(),e.prev=6,e.next=9,Z(r);case 9:e.sent,t.message="File uploaded.",e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),t.error=(0,O.b)(e.t0);case 16:case"end":return e.stop()}}),e,null,[[6,13]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){W(a,n,o,s,c,"next",e)}function c(e){W(a,n,o,s,c,"throw",e)}s(void 0)}))})()}},render:function(e,t,r,o,a,s){var c=(0,n.resolveComponent)("BaseBtn"),u=(0,n.resolveComponent)("FlashMessage");return(0,n.openBlock)(),(0,n.createBlock)("form",{onSubmit:t[2]||(t[2]=(0,n.withModifiers)((function(){return s.uploadFile&&s.uploadFile.apply(s,arguments)}),["prevent"]))},[(0,n.createVNode)("div",z,[(0,n.createVNode)("label",H,(0,n.toDisplayString)(r.label),1),(0,n.createVNode)("input",{type:"file",accept:r.fileTypes,onChange:t[1]||(t[1]=function(){return s.fileChange&&s.fileChange.apply(s,arguments)}),id:"file"},null,40,["accept"])]),(0,n.createVNode)(c,{text:"Upload"}),(0,n.createVNode)(u,{message:a.message,error:a.error},null,8,["message","error"])],32)}};function ee(e,t,r,n,o,a,s){try{var c=e[a](s),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function te(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){ee(a,n,o,s,c,"next",e)}function c(e){ee(a,n,o,s,c,"throw",e)}s(void 0)}))}}const re={props:["courseID"],emits:["unmounting","courseEdited"],components:{FlashMessage:X,FileUpload:Y},data:function(){return{error:null,message:null,courseForm:{name:"",description:"",img:"",dateStart:"",dateEnd:"",roster:[]},isSubmitted:!1,file:null,endpoint:"/images/store",students:[],studentID:"",enrollKey:{key:"",perm:!0,datetime:"",time:"",uses:""},joinKeys:[],keyURL:""}},methods:{initKeys:function(){var e=this;return te(J().mark((function t(){var r,n,o;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L.x.get("/invite/course/".concat(e.courseID));case 2:for(r=t.sent,console.log(r),n=r.data.data,o=0;o<n.length;o++)e.joinKeys.push(n[o]);case 6:case"end":return t.stop()}}),t)})))()},generateKey:function(){var e=this;return te(J().mark((function t(){var r,n,o,a;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={},""==e.enrollKey.key&&(e.enrollKey.key="random"),r.join_key=e.enrollKey.key,r.course_id=e.courseID,t.next=6,L.x.post("/invite",r);case 6:return n=t.sent,o=n.data.data.id,r.join_key=n.data.data.join_key,e.enrollKey.perm?r.expire_date=e.courseForm.dateEnd:r.expire_date=e.enrollKey.datetime,""==e.enrollKey.uses&&(e.enrollKey.uses=0),r.max_uses=e.enrollKey.uses,t.next=14,L.x.put("/invite/".concat(o),r);case 14:a=t.sent,e.joinKeys.push(a.data.data);case 16:case"end":return t.stop()}}),t)})))()},copyKey:function(e){this.keyURL="http://mocside.com:8000/"+e.join_key+"/enroll";var t=this.keyURL,r=document.createElement("textarea");r.value=t,document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r)},deleteKey:function(e,t){var r=this;return te(J().mark((function n(){return J().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,L.x.delete("/invite/".concat(e.id));case 2:n.sent,r.joinKeys=r.joinKeys.filter((function(e,r){return r!=t}));case 4:case"end":return n.stop()}}),n)})))()},handleSubmit:function(){var e=this;return te(J().mark((function t(){var r,n;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isSubmitted=!0,t.next=3,e.uploadImage();case 3:return r={name:e.courseForm.name,description:e.courseForm.description,img_loc:e.courseForm.img,start_date:e.courseForm.dateStart,end_date:e.courseForm.dateEnd},t.next=6,L.x.put("/courses/".concat(e.courseID),r);case 6:n=t.sent,alert("Processed finished with status code: "+n.statusCode),e.$emit("courseEdited");case 9:case"end":return t.stop()}}),t)})))()},updateImage:function(){console.log("updated the image")},clearMessage:function(){this.error=null,this.message=null},fileChange:function(e){this.clearMessage(),this.file=e.target.files[0]},uploadImage:function(){var e=this;return te(J().mark((function t(){var r,n,o;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==e.file){t.next=19;break}return r={},(n=new FormData).append("file",e.file),r.file=n,r.endpoint=e.endpoint,e.clearMessage(),t.prev=7,t.next=10,Z(r);case 10:o=t.sent,e.message="File uploaded.",console.log(o.data.asset_link),e.courseForm.img=o.data.asset_link,t.next=19;break;case 16:t.prev=16,t.t0=t.catch(7),e.error=(0,O.b)(t.t0);case 19:case"end":return t.stop()}}),t,null,[[7,16]])})))()},removeStudent:function(e,t){var r=this;return te(J().mark((function n(){var o,a,s;return J().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=0;case 1:if(!(o<r.courseForm.roster.length)){n.next=8;break}if(r.courseForm.roster[o]!=e.fsc_user.fsc_id){n.next=5;break}return r.courseForm.roster.splice(o,1),n.abrupt("break",8);case 5:o++,n.next=1;break;case 8:return n.next=10,r.updateRoster();case 10:n.sent,a=JSON.parse(e.fsc_user.courses).courses,s=0;case 13:if(!(s<a.length)){n.next=20;break}if(a[s]!=r.courseID){n.next=17;break}return a.splice(s,1),n.abrupt("break",20);case 17:s++,n.next=13;break;case 20:return n.next=22,r.updateStudentCourses(a);case 22:n.sent,r.students=r.students.filter((function(e,r){return r!=t}));case 24:case"end":return n.stop()}}),n)})))()},getStudents:function(){var e=this;return te(J().mark((function t(){var r,n;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=0;case 1:if(!(r<e.courseForm.roster.length)){t.next=9;break}return t.next=4,L.x.get("/students/".concat(e.courseForm.roster[r]));case 4:n=t.sent,e.students.push(n.data.data);case 6:r++,t.next=1;break;case 9:case"end":return t.stop()}}),t)})))()},addStudent:function(){var e=this;return te(J().mark((function t(){var r,n;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getStudent();case 3:return r=t.sent,e.courseForm.roster.push(e.studentID),t.next=7,e.updateRoster();case 7:return t.sent,(n=JSON.parse(r.data.data.fsc_user.courses).courses).push(e.courseID),t.next=12,e.updateStudentCourses(n);case 12:t.sent,e.students.push(r.data.data),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.log(t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})))()},getStudent:function(){var e=this;return te(J().mark((function t(){return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L.x.get("/students/".concat(e.studentID));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},updateRoster:function(){var e=this;return te(J().mark((function t(){var r;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={roster:JSON.stringify({roster:e.courseForm.roster})},t.next=3,L.x.put("/courses/".concat(e.courseID),r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},updateStudentCourses:function(e){return te(J().mark((function t(){return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return payload={courses:JSON.stringify({courses:e})},t.next=3,L.x.put("/students/".concat(stud.data.data.fsc_user.fsc_id),payload);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return te(J().mark((function t(){var r;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L.x.get("/courses/".concat(e.courseID));case 2:r=t.sent,e.courseForm.name=r.data.data.name,e.courseForm.description=r.data.data.description,e.courseForm.img=r.data.data.img_loc,e.courseForm.dateStart=r.data.data.start_date,e.courseForm.dateEnd=r.data.data.end_date,e.courseForm.roster=JSON.parse(r.data.data.roster).roster,e.getStudents(),e.initKeys();case 11:case"end":return t.stop()}}),t)})))()},beforeUnmount:function(){this.$emit("unmounting")},render:function(e,t,r,R,J,L){return(0,n.openBlock)(),(0,n.createBlock)("div",o,[a,(0,n.createVNode)("div",s,[(0,n.createVNode)("form",{onSubmit:t[12]||(t[12]=(0,n.withModifiers)((function(){return L.handleSubmit&&L.handleSubmit.apply(L,arguments)}),["prevent"])),class:"course-form"},[(0,n.createVNode)("div",c,[u,(0,n.withDirectives)((0,n.createVNode)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=function(e){return J.courseForm.name=e}),id:"courseName",name:"courseName",class:"form-control"},null,512),[[n.vModelText,J.courseForm.name]])]),l,(0,n.createVNode)("div",i,[d,(0,n.withDirectives)((0,n.createVNode)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(e){return J.courseForm.description=e}),id:"courseDescription",name:"courseDescription",class:"form-control"},null,512),[[n.vModelText,J.courseForm.description]])]),p,(0,n.createVNode)("div",f,[(0,n.createVNode)("div",m,[v,(0,n.createVNode)("input",{type:"file",accept:["image/*"],onChange:t[3]||(t[3]=function(){return L.fileChange&&L.fileChange.apply(L,arguments)}),id:"file"},null,32)])]),y,(0,n.createVNode)("div",h,[g,(0,n.createVNode)("div",x,[(0,n.withDirectives)((0,n.createVNode)("input",{type:"Date","onUpdate:modelValue":t[4]||(t[4]=function(e){return J.courseForm.dateStart=e}),id:"courseDateStart",name:"courseDateStart",class:"form-control col-4"},null,512),[[n.vModelText,J.courseForm.dateStart]]),(0,n.withDirectives)((0,n.createVNode)("input",{type:"Date","onUpdate:modelValue":t[5]||(t[5]=function(e){return J.courseForm.dateEnd=e}),id:"courseDateEnd",name:"courseDateEnd",class:"form-control col-7"},null,512),[[n.vModelText,J.courseForm.dateEnd]])])]),b,(0,n.createVNode)("div",k,[N,(0,n.createVNode)("ul",null,[((0,n.openBlock)(!0),(0,n.createBlock)(n.Fragment,null,(0,n.renderList)(J.students,(function(e,t){return(0,n.openBlock)(),(0,n.createBlock)("li",{key:e.id},[(0,n.createTextVNode)((0,n.toDisplayString)(e.name)+" ",1),(0,n.createVNode)("a",{onClick:function(r){return L.removeStudent(e,t)}},"X",8,["onClick"])])})),128))])]),V,(0,n.createVNode)("div",w,[(0,n.createVNode)("ul",null,[((0,n.openBlock)(!0),(0,n.createBlock)(n.Fragment,null,(0,n.renderList)(J.joinKeys,(function(e,t){return(0,n.openBlock)(),(0,n.createBlock)("li",{key:e},[(0,n.createTextVNode)((0,n.toDisplayString)(e.join_key)+" ",1),(0,n.createVNode)("a",{onClick:function(t){return L.copyKey(e)}},"Copy Url",8,["onClick"]),(0,n.createVNode)("a",{onClick:function(r){return L.deleteKey(e,t)}},"Delete Key",8,["onClick"])])})),128))]),(0,n.createVNode)("div",F,[S,(0,n.withDirectives)((0,n.createVNode)("input",{placeholder:"Random",type:"text","onUpdate:modelValue":t[6]||(t[6]=function(e){return J.enrollKey.key=e})},null,512),[[n.vModelText,J.enrollKey.key]]),C,D,(0,n.createVNode)("label",K,[(0,n.withDirectives)((0,n.createVNode)("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=function(e){return J.enrollKey.perm=e})},null,512),[[n.vModelCheckbox,J.enrollKey.perm]]),B]),_,M,(0,n.withDirectives)((0,n.createVNode)("input",{type:"date",disabled:J.enrollKey.perm,"onUpdate:modelValue":t[8]||(t[8]=function(e){return J.enrollKey.datetime=e})},null,8,["disabled"]),[[n.vModelText,J.enrollKey.datetime]]),U,E,(0,n.withDirectives)((0,n.createVNode)("input",{type:"time",disabled:J.enrollKey.perm,"onUpdate:modelValue":t[9]||(t[9]=function(e){return J.enrollKey.time=e})},null,8,["disabled"]),[[n.vModelText,J.enrollKey.time]]),I,T,(0,n.withDirectives)((0,n.createVNode)("input",{placeholder:"0 for unlimited use",type:"text","onUpdate:modelValue":t[10]||(t[10]=function(e){return J.enrollKey.uses=e})},null,512),[[n.vModelText,J.enrollKey.uses]])]),(0,n.createVNode)("button",{type:"button",onClick:t[11]||(t[11]=function(){return L.generateKey&&L.generateKey.apply(L,arguments)}),class:"btn btn-danger btn-block"}," Generate Course Enroll Key ")]),j,P],32)])])}},ne=re}}]);